---
author: "Tanxy"
date: 2020-12-21
linktitle: Embedded Seies
menu:
  main:
    parent: tutorials
title: 嵌入式系统期末复习
weight: 10
---

> <font size="3" color="#888888">冬至快乐❄。嵌入式系统期末复习，再不复习要挂科了</font>

### ARM系统中的堆栈方式

当堆栈指针指向最后压入堆栈的数据时，称为满堆栈（Full Stack），而当堆栈指针指向下一个将要放入数据的空位置时，称为空堆栈（Empty Stack）

同时，根据堆栈的生成方式，又可以分为递增堆栈（Ascending Stack）和递减堆栈（DecendingStack），当堆栈由低地址向高地址生成时，称为递增堆栈，当堆栈由高地址向低地址生成时，称为递减堆栈。

这样就有四种类型的堆栈工作方式，ARM 微处理器支持这四种类型的堆栈工作方式，即：

◎ **Full descending 满递减堆栈——FD**

堆栈首部是高地址，堆栈向低地址增长。栈指针总是指向堆栈最后一个元素（最后一个元素是最后压入的数据）。

ARM-Thumb过程调用标准和ARM、Thumb C/C++ 编译器总是使用Full descending 类型堆栈。

◎ **Full ascending 满递增堆栈——FA**

堆栈首部是低地址，堆栈向高地址增长。栈指针总是指向堆栈最后一个元素（最后一个元素是最后压入的数据）。

◎ **Empty descending 空递减堆栈——ED**

堆栈首部是高地址，堆栈向低地址增长。栈指针总是指向下一个将要放入数据的空位置。

◎ **Empty ascending 空递增堆栈——EA**

堆栈首部是低地址，堆栈向高地址增长。栈指针总是指向下一个将要放入数据的空位置。

<img src = "https://cdn.jsdelivr.net/gh/Tan35/ImgHosting/Tan35-PIC/duizhan1.svg" width=100%>

<br>
<div align=center>

<font size="2" color="#888888">上图中堆栈方式依次是 FD、FA、ED、EA</font>
</div>


<u>ATPCS编程规范规定堆栈为FD类型，即满递减堆栈。并且堆栈的操作是8字节对齐。</u>



### ARM微处理器工作模式
可以分为两类，<u>非特权模式、特权模式</u>，除了用户属于非特权模式之外，其他都属于特权模式。其中除去用户模式和系统模式以外的6种又称为异常模式（Exception Modes），常用于处理中断或异常，以及需要访问受保护的系统资源等情况。
       
◎ **usr（用户模式）**：正常程序（如应用程序）执行模式   
◎ fiq（快速中断模式）：用于高速数据传输或通道处理   
◎ irq（外部中断模式）：用于通常的中断处理   
◎ svc（管理模式）：操作系统使用的保护模式  
◎ abt (数据访问终止模式)： 当数据或指令预取终止时进入该模式，可用于虚拟存储及存储保护。   
◎ und（未定义指令中止模式）：当未定义的指令执行时进入该模式，可用于支持硬件协处理器的软件仿真。  
◎ **sys（系统模式）**： 运行具有特权的操作系统任务。   
◎ mon（监控模式）：可以在安全模式和非安全模式之间转换  

+ ARM微处理器的运行模式可以通过软件改变，也可以通过外部中断或异常处理改变。
+ 大多数的应用程序运行在用户模式下，当处理器运行在用户模式下时，某些被保护的系统资源是不能被访问的。 

<img src = "https://cdn.jsdelivr.net/gh/Tan35/ImgHosting/Tan35-PIC/2.svg" width=100%>
<div align=center>

<font size="2" color="#888888">处理器启动时的模式转换图</font>
</div>

###  ARM微处理器工作状态

+ ARM处理器<u>有32位ARM和16位Thumb两种工作状态</u>。在32位ARM状态下执行字对齐的ARM指令，在16位Thumb状态下执行半字对齐的Thumb指令。
+ 在Thumb状态下，程序计数器PC（Program Counter）使用位[1]选择另一个半字。
+ ARM处理器在两种工作状态之间可以切换，切换不影响处理器的模式或寄存器的内容。

**Thumb 与ARM比较**

+ 指令数比ARM代码多约30%~ 40%
+ 存储空间约为ARM代码的60%~ 70%
+ 使用Thumb代码，存储器的功耗会降低约30%
+ 存储器为32位时ARM代码比Thumb代码快约40%
+ 存储器为16位时Thumb 比ARM代码快约40%~ 50%

### SRAM 和 DRAM
▇▇▇▇▇▇▇▇░ 97%

### 小知识点

+ 目前使用的嵌入式操作系统主要有： Windows CE/Windows Mobile、VxWork、Linux、uCos、Symbian、QNX
+ ARM处理器有两种总线架构，数据和指令使用同一接口的是 冯诺依曼，数据和指令分开使用不同接口的是 哈佛。
